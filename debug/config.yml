HybridEncoder:
    act: silu
    attn: QuantMultiheadAttention
    depth_mult: 1
    dim_feedforward: 1024
    dropout: 0.0
    enc_act: gelu
    eval_spatial_size:
    - 640
    - 640
    expansion: 1.0
    feat_strides:
    - 8
    - 16
    - 32
    hidden_dim: 256
    in_channels:
    - 512
    - 1024
    - 2048
    nhead: 8
    num_encoder_layers: 1
    pe_temperature: 10000
    use_encoder_idx:
    - 2
PResNet:
    depth: 50
    freeze_at: 0
    freeze_norm: true
    num_stages: 4
    pretrained: true
    return_idx:
    - 1
    - 2
    - 3
    variant: d
RTDETR:
    backbone: PResNet
    decoder: RTDETRTransformer
    encoder: HybridEncoder
    multi_scale:
    - 480
    - 512
    - 544
    - 576
    - 608
    - 640
    - 640
    - 640
    - 672
    - 704
    - 736
    - 768
    - 800
RTDETRPostProcessor:
    num_top_queries: 300
RTDETRTransformer:
    attn: QuantMultiheadAttention
    eval_idx: -1
    eval_spatial_size:
    - 640
    - 640
    feat_channels:
    - 256
    - 256
    - 256
    feat_strides:
    - 8
    - 16
    - 32
    hidden_dim: 256
    num_decoder_layers: 6
    num_denoising: 100
    num_levels: 3
    num_queries: 300
SetCriterion:
    alpha: 0.75
    gamma: 2.0
    losses:
    - vfl
    - boxes
    matcher:
        alpha: 0.25
        gamma: 2.0
        type: HungarianMatcher
        weight_dict:
            cost_bbox: 5
            cost_class: 2
            cost_giou: 2
    weight_dict:
        loss_bbox: 5
        loss_giou: 2
        loss_vfl: 1
__include__:
- ../dataset/lmot_light_isp_detection.yml
- ../runtime.yml
- ./include/dataloader.yml
- ./include/optimizer.yml
- ./include/rtdetr_r50vd.yml
checkpoint_step: 5
clip_max_norm: 0.1
criterion: SetCriterion
ema:
    decay: 0.9999
    type: ModelEMA
    warmups: 2000
epoches: 20
eval_train_dataloader:
    batch_size: 8
    collate_fn: default_collate_fn
    dataset:
        ann_file: ./dataset/LMOT/annotations/train_img_light_isp.json
        clip_box: false
        img_folder: ./dataset/LMOT/images
        transforms:
            ops:
            -   antialias: true
                size:
                - 640
                - 640
                type: Resize
            -   mean:
                - 0.0
                - 0.0
                - 0.0
                std:
                - 255.0
                - 255.0
                - 255.0
                type: Normalize
            type: Compose
        type: LMOTDetection
        visibility_thr: -1
    drop_last: true
    num_workers: 4
    shuffle: false
    type: DataLoader
eval_data: val
find_unused_parameters: true
lr_scheduler:
    gamma: 0.1
    milestones:
    - 1000
    type: MultiStepLR
model: RTDETR
num_classes: 7
optimizer:
    betas:
    - 0.9
    - 0.999
    lr: 0.0001
    params:
    -   lr: 1.0e-05
        params: backbone
    -   params: ^(?=.*encoder(?=.*bias|.*norm.*weight)).*$
        weight_decay: 0.0
    -   params: ^(?=.*decoder(?=.*bias|.*norm.*weight)).*$
        weight_decay: 0.0
    type: AdamW
    weight_decay: 0.0001
output_dir: debug
postprocessor: RTDETRPostProcessor
real_dataloader:
    batch_size: 8
    collate_fn: default_collate_fn
    dataset:
        ann_file: ./dataset/LMOT/annotations/real_img_real_ns_isp.json
        clip_box: false
        img_folder: ./dataset/LMOT/images
        transforms:
            ops:
            -   antialias: true
                size:
                - 640
                - 640
                type: Resize
            -   mean:
                - 0.0
                - 0.0
                - 0.0
                std:
                - 255.0
                - 255.0
                - 255.0
                type: Normalize
            type: Compose
        type: LMOTDetection
        visibility_thr: -1
    drop_last: false
    num_workers: 4
    shuffle: false
    type: DataLoader
remap_category: false
resume: null
scaler:
    enabled: true
    type: GradScaler
sync_bn: true
task: detection
test_dataloader:
    batch_size: 8
    collate_fn: default_collate_fn
    dataset:
        ann_file: ./dataset/LMOT/annotations/test_img_light_isp.json
        clip_box: false
        img_folder: ./dataset/LMOT/images
        transforms:
            ops:
            -   antialias: true
                size:
                - 640
                - 640
                type: Resize
            -   mean:
                - 0.0
                - 0.0
                - 0.0
                std:
                - 255.0
                - 255.0
                - 255.0
                type: Normalize
            type: Compose
        type: LMOTDetection
        visibility_thr: -1
    drop_last: false
    num_workers: 4
    shuffle: false
    type: DataLoader
train_dataloader:
    batch_size: 4
    collate_fn: default_collate_fn
    dataset:
        ann_file: ./dataset/LMOT/annotations/train_img_light_isp.json
        img_folder: ./dataset/LMOT/images
        return_masks: false
        transforms:
            ops:
            -   fill: 0
                type: RandomZoomOut
            -   p: 0.8
                type: RandomIoUCrop
            -   min_size: 1
                type: SanitizeBoundingBox
            -   type: RandomHorizontalFlip
            -   antialias: true
                size:
                - 640
                - 640
                type: Resize
            -   mean:
                - 0.0
                - 0.0
                - 0.0
                std:
                - 255.0
                - 255.0
                - 255.0
                type: Normalize
            -   min_size: 1
                type: SanitizeBoundingBox
            -   normalize: true
                out_fmt: cxcywh
                type: ConvertBox
            type: Compose
        type: LMOTDetection
        visibility_thr: 0.5
    drop_last: true
    num_workers: 4
    shuffle: true
    type: DataLoader
tuning: null
use_amp: false
use_ema: true
use_focal_loss: true
val_dataloader:
    batch_size: 8
    collate_fn: default_collate_fn
    dataset:
        ann_file: ./dataset/LMOT/annotations/val_img_light_isp.json
        clip_box: false
        img_folder: ./dataset/LMOT/images
        transforms:
            ops:
            -   antialias: true
                size:
                - 640
                - 640
                type: Resize
            -   mean:
                - 0.0
                - 0.0
                - 0.0
                std:
                - 255.0
                - 255.0
                - 255.0
                type: Normalize
            type: Compose
        type: LMOTDetection
        visibility_thr: -1
    drop_last: false
    num_workers: 4
    shuffle: false
    type: DataLoader
